<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>mirai-ts</title><meta name="description" content="Documentation for mirai-ts"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">mirai-ts</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>mirai-ts</h2></div><div class="tsd-panel tsd-typography"><a id="md:mirai-ts" class="tsd-anchor"></a><h1 class="tsd-anchor-link"><a href="https://github.com/YunYouJun/mirai-ts" target="_blank" class="external">mirai-ts</a><a href="#md:mirai-ts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://yunyoujun.github.io/mirai-ts/" target="_blank" class="external"><img src="https://github.com/YunYouJun/mirai-ts/workflows/docs/badge.svg" alt="docs"></a>
<a href="https://github.com/project-mirai/mirai-api-http" target="_blank" class="external"><img src="https://img.shields.io/badge/mirai--api--http-v2.3.3-blue" alt="Compatible Version"></a>
<a href="https://www.npmjs.com/package/mirai-ts" target="_blank" class="external"><img src="https://img.shields.io/npm/v/mirai-ts" alt="npm"></a>
<a href="https://github.com/YunYouJun/mirai-ts" target="_blank" class="external"><img src="https://img.shields.io/github/license/YunYouJun/mirai-ts" alt="GitHub"></a>
<a href="https://www.codacy.com/gh/YunYouJun/mirai-ts/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=YunYouJun/mirai-ts&amp;utm_campaign=Badge_Grade" target="_blank" class="external"><img src="https://app.codacy.com/project/badge/Grade/9b332231afb643df83b59cc8b4188278" alt="Codacy Badge"></a></p>
<!-- [![GitHub release (latest SemVer)](https://img.shields.io/github/v/release/project-mirai/mirai-api-http?label=mirai-api-http)](https://github.com/project-mirai/mirai-api-http) -->
<p><a href="https://github.com/mamoe/mirai-api-http" target="_blank" class="external">mirai-api-http</a> 的 JavaScript/TypeScript SDK，附带声明文件，拥有良好的注释和类型提示。可运行于 Node.js 与浏览器端。</p>
<p><img src="https://user-images.githubusercontent.com/25154432/110353530-1f9de280-8072-11eb-94b0-addcd8ca1ca4.png" alt="shindo-ai.gif"></p>
<blockquote>
<p>除了 Node.js，它还兼容浏览器端。这意味着你可以使用它来开发 Web 界面与你的 mirai 机器人进行交互。（可以参考还在咕的 <a href="https://github.com/ElpsyCN/el-bot-web" target="_blank" class="external">el-bot-web</a>）</p>
</blockquote>
<a id="md:如何使用" class="tsd-anchor"></a><h2 class="tsd-anchor-link">如何使用<a href="#md:如何使用" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><blockquote>
<p>自行配置好你的 <a href="https://github.com/mamoe/mirai" target="_blank" class="external">mirai</a> 与 <a href="https://github.com/project-mirai/mirai-api-http" target="_blank" class="external">mirai-api-http</a>，确保 <code>localhost:你配置的端口号/about</code> 是可访问的。
<a href="https://github.com/project-mirai/mirai-api-http#settingyml%E6%A8%A1%E6%9D%BF" target="_blank" class="external">settings.yml</a> 中 <code>adapterSettings</code> 的 <code>http</code> 与 <code>ws</code> 是必须的。</p>
</blockquote>
<pre><code class="sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">mirai-ts</span><br/><span class="hl-3"># yarn add mirai-ts</span><br/><br/><span class="hl-3"># 尝试新版本（比如 ES Module）</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1"> </span><span class="hl-2">mirai-ts@next</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>由于 mirai-api-http 2.x 已经稳定，mirai-ts@latest 为 2.x 版本，如果您想使用 mirai-api-http 1.x，请安装 <a href="https://www.npmjs.com/package/mirai-ts/v/1.1.1" target="_blank" class="external">mirai-ts@1.x</a> 版本。</p>
</blockquote>
<ul>
<li><a href="https://yunyoujun.github.io/mirai-ts/" target="_blank" class="external">API 文档</a></li>
<li><a href="media/migrate.md">2.x 迁移指南</a></li>
</ul>
<a id="md:快速开始" class="tsd-anchor"></a><h2 class="tsd-anchor-link">快速开始<a href="#md:快速开始" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:javascript" class="tsd-anchor"></a><h3 class="tsd-anchor-link">JavaScript<a href="#md:javascript" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><a href="media/index.js">示例代码</a></p>
<pre><code class="sh"><span class="hl-0">node</span><span class="hl-1"> </span><span class="hl-2">demo/index.js</span>
</code><button type="button">Copy</button></pre>

<a id="md:typescript" class="tsd-anchor"></a><h3 class="tsd-anchor-link">TypeScript<a href="#md:typescript" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><a href="media/index.ts">示例代码</a></p>
<pre><code class="sh"><span class="hl-0">ts-node</span><span class="hl-1"> </span><span class="hl-2">demo/index.ts</span>
</code><button type="button">Copy</button></pre>

<a id="md:browser" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Browser<a href="#md:browser" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>基于 mirai-ts 开发面向浏览器端的应用程序时，您还需要安装 <a href="https://github.com/browserify/events" target="_blank" class="external">events</a> 以在浏览器端替代 Node.js 原生 events 模块。</p>
<pre><code class="sh"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1"> </span><span class="hl-2">events</span><br/><span class="hl-3"># yarn add events</span><br/><span class="hl-3"># npm install events mirai-ts</span>
</code><button type="button">Copy</button></pre>

<a id="md:why-typescript--mirai-ts" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Why Typescript &amp; mirai-ts?<a href="#md:why-typescript--mirai-ts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><blockquote>
<p>Make JavaScript Great Again!</p>
</blockquote>
<ul>
<li>更友好的提示：TypeScript 配合 VSCode 代码提示有奇效。</li>
<li>更清晰的语义：函数命名与 mirai-api-http 保持一致。</li>
<li>更易懂的注释：因为会用到 QQ 机器人 99.99% 是国人，所以是全中文注释。</li>
<li>更优雅的结构：看起来是在自吹自擂，但自我感觉良好。</li>
<li>更广泛的平台：支持 Node.js 与浏览器端，以及 WebSocket。</li>
</ul>
<a id="md:简介" class="tsd-anchor"></a><h2 class="tsd-anchor-link">简介<a href="#md:简介" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:结构" class="tsd-anchor"></a><h3 class="tsd-anchor-link">结构<a href="#md:结构" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>types</code> 目录下为对应类型定义</p>
<ul>
<li><code>api</code>: API 发送与响应
<ul>
<li><code>response</code>: API 响应格式</li>
</ul>
</li>
<li><code>contact</code>: 用户信息格式（如 Friend, Member, Group 等）</li>
<li><code>event-type</code>: 事件类型</li>
<li><code>message-type</code>: 消息类型</li>
</ul>
<a id="md:工具类" class="tsd-anchor"></a><h3 class="tsd-anchor-link">工具类<a href="#md:工具类" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="js"><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">Message</span><span class="hl-1">, </span><span class="hl-5">Logger</span><span class="hl-1">, </span><span class="hl-5">check</span><span class="hl-1">, </span><span class="hl-5">MessageType</span><span class="hl-1">, </span><span class="hl-5">EventType</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&#39;mirai-ts&#39;</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-7">EventType</span><span class="hl-1">, </span><span class="hl-7">Logger</span><span class="hl-1">, </span><span class="hl-7">Message</span><span class="hl-1">, </span><span class="hl-7">MessageType</span><span class="hl-1">, </span><span class="hl-7">check</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mirai-ts&#39;</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>详情请参见 <a href="https://yunyoujun.github.io/mirai-ts/" target="_blank" class="external">API 文档</a>。</p>
</blockquote>
<a id="md:message" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><a href="https://yunyoujun.github.io/mirai-ts/modules.html#message" target="_blank" class="external">Message</a><a href="#md:message" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><code>Message</code>: 生成对应消息的辅助方法，如生成艾特某人的消息 <code>Message.At(qq)</code></li>
</ul>
<blockquote>
<p>消息链应当是一个数组，如 <code>messageChain = [Message.At(qq), Message.Plain('来点色图')]</code></p>
</blockquote>
<a id="md:logger" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><a href="https://yunyoujun.github.io/mirai-ts/classes/logger.html" target="_blank" class="external">Logger</a><a href="#md:logger" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>简单的日志工具，当然你可以自由使用其他工具替代它。</p>
<pre><code class="ts"><span class="hl-6">import</span><span class="hl-1"> { </span><span class="hl-7">Logger</span><span class="hl-1"> } </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mirai-ts&#39;</span><br/><span class="hl-3">// 你可以自定义你的前缀</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Logger</span><span class="hl-1">({ </span><span class="hl-7">prefix:</span><span class="hl-1"> </span><span class="hl-2">&#39;[mirai-ts]&#39;</span><span class="hl-1"> })</span><br/><span class="hl-7">logger</span><span class="hl-1">.</span><span class="hl-0">success</span><span class="hl-1">(</span><span class="hl-2">&#39;We are free!&#39;</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<a id="md:check" class="tsd-anchor"></a><h4 class="tsd-anchor-link"><a href="https://yunyoujun.github.io/mirai-ts/modules/check.html" target="_blank" class="external">check</a><a href="#md:check" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>消息匹配与检测。</p>
<p>如判断消息链是否有艾特某人：</p>
<pre><code class="js"><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">check</span><span class="hl-1"> } = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&#39;mirai-ts&#39;</span><span class="hl-1">)</span><br/><span class="hl-3">// msg 为消息链 MessageChain</span><br/><span class="hl-3">// qq 为 QQ 号</span><br/><span class="hl-7">check</span><span class="hl-1">.</span><span class="hl-0">isAt</span><span class="hl-1">(</span><span class="hl-7">msg</span><span class="hl-1">, </span><span class="hl-7">qq</span><span class="hl-1">)</span><br/><br/><span class="hl-3">// or just</span><br/><span class="hl-7">msg</span><span class="hl-1">.</span><span class="hl-0">isAt</span><span class="hl-1">(</span><span class="hl-7">qq</span><span class="hl-1">)</span><br/><span class="hl-3">// 留空则判断是否艾特机器人自身</span>
</code><button type="button">Copy</button></pre>

<a id="md:示例模版" class="tsd-anchor"></a><h2 class="tsd-anchor-link">示例模版<a href="#md:示例模版" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://github.com/YunYouJun/el-bot/" target="_blank" class="external">el-bot</a>：你可以参考它的使用方式，你也可以直接使用它。</li>
</ul>
<p>el-bot 展示了整个 mirai-ts 的使用流程，并内置了一些如自动应答、转发、命令行、RSS 等常用功能（默认插件），开箱即用。</p>
<p>你只需要一些自定义的配置，而不再需要编写繁琐的脚本内容。</p>
<p>但这并不是束缚，在插件系统中你仍然可以调用机器人所有的上下文，并通过编写插件的形式快速实现你想要的功能。</p>
<blockquote>
<p>更多请参见文档 <a href="https://docs.bot.elpsy.cn/" target="_blank" class="external">el-bot | El Bot Docs</a></p>
</blockquote>
<a id="md:开发" class="tsd-anchor"></a><h2 class="tsd-anchor-link">开发<a href="#md:开发" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-3"># clone 本项目</span><br/><span class="hl-0">git</span><span class="hl-1"> </span><span class="hl-2">clone</span><span class="hl-1"> </span><span class="hl-2">https://github.com/YunYouJun/mirai-ts</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">mirai-ts</span><br/><br/><span class="hl-3"># 安装 mirai-console-loader，放置于 `mirai-ts/mcl` 文件夹下</span><br/><span class="hl-3"># https://github.com/iTXTech/mirai-console-loader</span><br/><span class="hl-0">mkdir</span><span class="hl-1"> </span><span class="hl-2">mcl</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">mcl</span><br/><span class="hl-3"># 修改链接下载 mcl 对应版本</span><br/><span class="hl-0">wget</span><span class="hl-1"> </span><span class="hl-2">https://github.com/iTXTech/mirai-console-loader/releases/download/v2.1.1/mcl-2.1.1.zip</span><br/><span class="hl-0">unzip</span><span class="hl-1"> </span><span class="hl-2">mcl-2.1.1.zip</span><br/><span class="hl-0">chmod</span><span class="hl-1"> </span><span class="hl-2">+x</span><span class="hl-1"> </span><span class="hl-2">mcl</span><br/><span class="hl-0">./mcl</span><br/><br/><span class="hl-3"># 使用 mcl 安装 mirai-api-http</span><br/><span class="hl-3"># https://github.com/project-mirai/mirai-api-http#%E5%AE%89%E8%A3%85mirai-api-http</span><br/><span class="hl-0">./mcl</span><span class="hl-1"> </span><span class="hl-4">--update-package</span><span class="hl-1"> </span><span class="hl-2">net.mamoe:mirai-api-http</span><span class="hl-1"> </span><span class="hl-4">--channel</span><span class="hl-1"> </span><span class="hl-2">stable-v2</span><span class="hl-1"> </span><span class="hl-4">--type</span><span class="hl-1"> </span><span class="hl-2">plugin</span><br/><span class="hl-3"># mcl 自动更新</span><br/><span class="hl-0">./mcl</span><span class="hl-1"> </span><span class="hl-4">-u</span><br/><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">..</span><br/><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">mcl</span><br/><br/><span class="hl-3"># 参考 https://github.com/project-mirai/mirai-login-solver-selenium 获取 ticket</span><br/><br/><span class="hl-3"># 开发（监听文件变动并构建）（打开新终端窗口）</span><br/><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">dev</span><br/><br/><span class="hl-3"># 启动 demo（打开新终端窗口）</span><br/><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">demo</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:mirai-ts"><span>mirai-<wbr/>ts</span></a><ul><li><a href="#md:如何使用"><span>如何使用</span></a></li><li><a href="#md:快速开始"><span>快速开始</span></a></li><li><ul><li><a href="#md:javascript"><span>Java<wbr/>Script</span></a></li><li><a href="#md:typescript"><span>Type<wbr/>Script</span></a></li><li><a href="#md:browser"><span>Browser</span></a></li></ul></li><li><a href="#md:why-typescript--mirai-ts"><span>Why <wbr/>Typescript &amp; mirai-<wbr/>ts?</span></a></li><li><a href="#md:简介"><span>简介</span></a></li><li><ul><li><a href="#md:结构"><span>结构</span></a></li><li><a href="#md:工具类"><span>工具类</span></a></li><li><ul><li><a href="#md:message"><span>Message</span></a></li><li><a href="#md:logger"><span>Logger</span></a></li><li><a href="#md:check"><span>check</span></a></li></ul></li></ul></li><li><a href="#md:示例模版"><span>示例模版</span></a></li><li><a href="#md:开发"><span>开发</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>mirai-ts</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
